# -- Override the name of the chart
nameOverride: ""
# -- Override the full name of the chart
fullnameOverride: ""

image:
  # -- Image registry
  registry: ghcr.io
  # -- Image repository
  repository: vince-riv/aks-node-termination-handler
  # -- Image tag (defaults to appVersion if not set)
  tag: ""
  # -- Image pull policy
  pullPolicy: IfNotPresent
  # -- Image pull secrets
  pullSecrets: []

args: []
env: []

priorityClassName: ""

# -- Labels to add to all deployed resources
commonLabels: {}
# -- Annotations to add to all deployed resources
commonAnnotations: {}

# -- Labels to add to the pods
podLabels: {}
# -- Annotations to add to the pods
podAnnotations: {}

configMap:
  create: true
  name: "{{ .Release.Name }}-files"
  mountPath: /files
  data: {}
    # slack-payload.json: |
    #   {
    #     "channel": "#mychannel",
    #     "username": "webhookbot",
    #     "text": "This is message for {{ .NodeName }}, {{ .InstanceType }} from {{ .NodeRegion }}",
    #     "icon_emoji": ":ghost:"
    #   }
    # prometheus-pushgateway-payload.txt: |
    #   node_termination_event{node="{{ .NodeName }}"} 1

extraVolumes: []
extraVolumeMounts: []

networkPolicy:
  enabled: false
  # controlPlaneIP: "123.X.X.X" # If not provided, network policy will allow all access to port 443/tcp
  # additionalEgressRules:
  # - ports:
  #   - port: 443
  #     protocol: TCP
  #   to:
  #   - ipBlock:
  #       cidr: 124.X.X.X/24

metrics:
  addAnnotations: true

hostNetwork: false

securityContext:
  runAsNonRoot: true
  privileged: false
  readOnlyRootFilesystem: true
  allowPrivilegeEscalation: false
  capabilities:
    drop:
    - ALL
  windowsOptions:
    runAsUserName: "ContainerUser"
  seccompProfile:
    type: RuntimeDefault

affinity: {}

tolerations:
- key: "kubernetes.azure.com/scalesetpriority"
  operator: "Equal"
  value: "spot"
  effect: "NoSchedule"

nodeSelector: {}
# if you want handle events only from spot instances
# nodeSelector:
#   kubernetes.azure.com/scalesetpriority: spot

resources:
  limits:
    memory: 100Mi
  requests:
    cpu: 20m
    memory: 100Mi

# -- Startup probe configuration
# Allows 5 minutes for instance metadata service to become available
startupProbe:
  httpGet:
    path: /healthz
    port: http
    scheme: HTTP
  periodSeconds: 10
  timeoutSeconds: 5
  failureThreshold: 30

# -- Liveness probe configuration
livenessProbe:
  httpGet:
    path: /healthz
    port: http
    scheme: HTTP
  periodSeconds: 30
  timeoutSeconds: 5
